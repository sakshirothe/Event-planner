<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI University Event Planner - Cool Tone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Custom styles for Inter font and general body */
        body {
            font-family: 'Inter', sans-serif;
            /* Cool Tone Theme: Blue/Green gradient with subtle glow */
            background: radial-gradient(circle at center, #0a1a2a 0%, #05101a 50%, #000a10 100%);
            color: #e0e0e0; /* Lighter text for dark background */
            min-height: 100vh;
            display: flex;
            flex-flex-direction: column;
            overflow-x: hidden; /* Prevent horizontal scroll from animations */
        }

        /* Glitch Effect for text - Adjusted for cool tones */
        .glitch-text {
            animation: glitch 1.5s infinite;
            position: relative;
            display: inline-block;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        /* Pulsating Glow for elements - Adjusted for cool tones */
        .pulse-glow {
            animation: pulseGlow 2s infinite alternate;
        }

        @keyframes pulseGlow {
            0% { box-shadow: 0 0 5px rgba(0, 150, 255, 0.4), 0 0 10px rgba(0, 255, 150, 0.2); }
            100% { box-shadow: 0 0 15px rgba(0, 150, 255, 0.8), 0 0 25px rgba(0, 255, 150, 0.4); }
        }

        /* Custom styling for tooltips - Adjusted for cool tones */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 180px;
            background-color: #002233; /* Darker, cool tooltip background */
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -90px;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.4);
            border: 1px solid #00aaff; /* Blue border */
        }

        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #002233 transparent transparent transparent;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Loading spinner animation - Adjusted for cool tones */
        .spinner {
            border: 4px solid rgba(0, 150, 255, 0.2);
            border-left-color: #00aaff; /* Blue spinner */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal specific styles - Adjusted for cool tones */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8); /* Even darker overlay */
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: #05101a; /* Dark, cool modal background */
            color: #e0e0e0;
            margin: auto;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 150, 255, 0.4), 0 0 30px rgba(0, 255, 150, 0.2); /* Blue/green glow */
            width: 90%;
            max-width: 500px;
            text-align: center;
            transform: scale(0.8); /* Start smaller */
            transition: transform 0.4s ease;
            border: 2px solid #00aaff; /* Blue border */
        }

        .modal.show .modal-content {
            transform: scale(1); /* Scale up */
        }

        .close-button {
            color: #00aaff; /* Blue close button */
            float: right;
            font-size: 32px;
            font-weight: bold;
            line-height: 1;
        }

        .close-button:hover,
        .close-button:focus {
            color: #55ccff;
            text-decoration: none;
            cursor: pointer;
        }

        /* Enhanced button styles - Adjusted for cool tones */
        .btn-primary {
            background: linear-gradient(45deg, #003366, #0055aa); /* Dark blue gradient */
            color: #e0e0e0; /* Lighter text */
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            border: 1px solid #00aaff; /* Blue border */
        }
        .btn-primary:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 6px 12px rgba(0, 150, 255, 0.4), 0 0 15px rgba(0, 255, 150, 0.2); /* Blue/green glow on hover */
            background: linear-gradient(45deg, #0055aa, #003366); /* Invert gradient on hover */
        }
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1); /* Subtle shimmer */
            transform: skewX(-30deg);
            transition: all 0.5s ease;
            z-index: -1;
        }
        .btn-primary:hover::before {
            left: 100%;
        }

        /* Specific styles for action buttons - adjusted for theme */
        #downloadPdfBtn {
            background: linear-gradient(45deg, #004d40, #00806a); /* Dark teal gradient */
            border-color: #00ccaa;
        }
        #downloadPdfBtn:hover {
            background: linear-gradient(45deg, #00806a, #004d40);
        }

        #editPlanBtn {
            background: linear-gradient(45deg, #4d4d00, #808000); /* Dark yellow/green gradient - keeping for contrast */
            border-color: #ffff00;
        }
        #editPlanBtn:hover {
            background: linear-gradient(45deg, #808000, #4d4d00);
        }

        #startNewBtn {
            background: linear-gradient(45deg, #660000, #990000); /* Darker red gradient - keeping for danger/reset contrast */
            border-color: #ff0000;
        }
        #startNewBtn:hover {
            background: linear-gradient(45deg, #990000, #660000);
        }

        /* Card enhancements - adjusted for theme */
        .card {
            background-color: rgba(5, 10, 26, 0.8); /* Semi-transparent dark blue */
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 150, 255, 0.2), 0 0 20px rgba(0, 255, 150, 0.1); /* Subtle blue/green glow */
            padding: 24px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #003366; /* Dark blue border */
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 150, 255, 0.4), 0 0 30px rgba(0, 255, 150, 0.2); /* More pronounced glow */
        }

        /* Input field focus glow - adjusted for theme */
        input:focus, select:focus {
            border-color: #00aaff; /* Blue border on focus */
            box-shadow: 0 0 0 3px rgba(0, 150, 255, 0.4); /* Blue glow */
            outline: none;
        }

        /* Header gradient - adjusted for theme */
        header {
            background: linear-gradient(90deg, #001122, #002244, #003366); /* Darker, more ominous blue gradient */
            border-bottom: 2px solid #00aaff; /* Blue border */
        }

        /* Icon colors */
        .text-blue-500 {
            color: #00ccff; /* Bright blue for icons */
        }
        .text-gray-700 {
            color: #c0c0c0; /* Lighter grey for labels */
        }
        .text-gray-800 {
            color: #e0e0e0; /* Lighter grey for main headings */
        }
        .text-gray-900 {
            color: #ffffff; /* White for important text */
        }
        .text-gray-600 {
            color: #a0a0a0; /* Medium grey */
        }
        .text-gray-500 {
            color: #808080; /* Darker grey for tooltips info icon */
        }
        .text-blue-600 {
            color: #00ccff; /* Bright blue for hashtags */
        }
        .text-sm.font-light {
            color: #e0e0e0; /* Table text */
        }
        .bg-gray-100 {
            background-color: #002233; /* Darker table header */
            color: #e0e0e0;
        }
        .border-gray-200 {
            border-color: #003366; /* Darker table borders */
        }
        .hover\:bg-gray-50:hover {
            background-color: #0a1a2a; /* Darker table row hover */
        }
        .bg-gray-50 {
            background-color: #05101a; /* Darker pre background */
        }


        /* Section entry animation */
        .fade-in-up {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease-out forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* New animations */
        .slide-in-left {
            opacity: 0;
            transform: translateX(-50px);
            animation: slideInLeft 0.7s ease-out forwards;
        }

        @keyframes slideInLeft {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide-in-right {
            opacity: 0;
            transform: translateX(50px);
            animation: slideInRight 0.7s ease-out forwards;
        }

        @keyframes slideInRight {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .scale-in {
            opacity: 0;
            transform: scale(0.8);
            animation: scaleIn 0.5s ease-out forwards;
        }

        @keyframes scaleIn {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <header class="text-white p-4 shadow-md sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold glitch-text">AI University Event Planner</h1>
            <nav>
                </nav>
        </div>
    </header>

    <main class="flex-grow container mx-auto p-4 md:p-8">
        <div class="rounded-lg shadow-xl p-6 md:p-8 mb-8 card pulse-glow">
            <h2 class="text-3xl font-extrabold text-center mb-6 glitch-text">Plan Your University Event</h2>
            <form id="eventForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="relative">
                    <label for="eventType" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-calendar-alt mr-2"></i>Event Type
                    </label>
                    <select id="eventType" name="eventType" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                        <option value="">Select Event Type</option>
                        <option value="Seminar">Seminar</option>
                        <option value="Fest">Fest</option>
                        <option value="Hackathon">Hackathon</option>
                        <option value="Workshop">Workshop</option>
                        <option value="Conference">Conference</option>
                        <option value="Cultural Event">Cultural Event</option>
                        <option value="Sports Event">Sports Event</option>
                        <option value="Webinar">Webinar</option>
                        <option value="Exhibition">Exhibition</option>
                    </select>
                </div>

                <div class="relative">
                    <label for="audience" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-users mr-2"></i>Audience
                    </label>
                    <input type="text" id="audience" name="audience" placeholder="e.g., All University Students, Engineering Freshmen" required
                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                </div>

                <div class="relative">
                    <label for="theme" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-palette mr-2"></i>Theme
                    </label>
                    <input type="text" id="theme" name="theme" placeholder="e.g., Future of AI, Sustainable Living" required
                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                </div>

                <div class="relative">
                    <label for="eventDate" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-calendar-day mr-2"></i>Date
                    </label>
                    <input type="date" id="eventDate" name="eventDate" required
                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                </div>

                <div class="relative">
                    <label for="duration" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-hourglass-half mr-2"></i>Duration (Days)
                    </label>
                    <input type="number" id="duration" name="duration" min="0.5" step="0.5" placeholder="e.g., 1, 0.5" required
                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                </div>

                <div class="relative">
                    <label for="mode" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-globe mr-2"></i>Mode
                    </label>
                    <select id="mode" name="mode" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                        <option value="">Select Mode</option>
                        <option value="Online">Online</option>
                        <option value="Offline">Offline</option>
                        <option value="Hybrid">Hybrid</option>
                    </select>
                </div>

                <div id="venueGroup" class="relative hidden">
                    <label for="venue" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-map-marker-alt mr-2"></i>Venue
                        <span class="tooltip text-xs ml-1">
                            <i class="fas fa-info-circle"></i>
                            <span class="tooltiptext">Click to autofill nearest venues based on your location.</span>
                        </span>
                    </label>
                    <input type="text" id="venue" name="venue" placeholder="e.g., University Auditorium, City Convention Center"
                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                    <button type="button" id="autofillVenueBtn" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 rounded-full bg-blue-700 text-white hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                        <i class="fas fa-location-crosshairs"></i>
                    </button>
                </div>

                <div class="relative">
                    <label for="budgetLimit" class="block text-sm font-semibold mb-2">
                        <i class="fas fa-money-bill-wave mr-2"></i>Budget Limit (INR)
                        <span class="tooltip text-xs ml-1">
                            <i class="fas fa-info-circle"></i>
                            <span class="tooltiptext">Estimated budget in Indian Rupees.</span>
                        </span>
                    </label>
                    <input type="number" id="budgetLimit" name="budgetLimit" min="0" placeholder="e.g., 50000" required
                           class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 transition duration-200 bg-gray-900 text-white">
                </div>

                <div class="md:col-span-2 flex justify-center mt-6">
                    <button type="submit"
                            class="btn-primary font-bold py-3 px-8 rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-blue-300 scale-in">
                        <i class="fas fa-magic mr-2"></i>Generate Plan
                    </button>
                </div>
            </form>
        </div>

        <div id="loadingSpinner" class="hidden flex flex-col justify-center items-center py-10">
            <div class="spinner mb-4 pulse-glow"></div>
            <p class="text-lg text-gray-600 glitch-text">Generating your event plan...</p>
            <p class="text-sm text-gray-500 mt-2">This might take a moment as our AI crafts the perfect plan!</p>
        </div>

        <div id="planOutput" class="hidden">
            <h2 class="text-3xl font-extrabold text-center mb-8 fade-in-up glitch-text">Your Event Plan</h2>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="card fade-in-up" style="animation-delay: 0.1s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-heading mr-3"></i>Event Title</h3>
                    <p id="outputTitle" class="text-xl font-semibold"></p>
                </div>
                <div class="card fade-in-up" style="animation-delay: 0.2s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-file-alt mr-3"></i>Event Description</h3>
                    <p id="outputDescription" class="leading-relaxed"></p>
                </div>
            </div>

            <div id="sportsContent" class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8 hidden">
                <div class="card slide-in-left" style="animation-delay: 0.3s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-trophy mr-3"></i>Sports Seminar Name Ideas</h3>
                    <ul id="outputSportsNames" class="list-disc list-inside space-y-2">
                        </ul>
                </div>
                <div class="card slide-in-right" style="animation-delay: 0.4s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-quote-left mr-3"></i>Motivational Sports Quotes</h3>
                    <ul id="outputSportsQuotes" class="list-disc list-inside space-y-2">
                        </ul>
                </div>
            </div>

            <div class="card mb-8 fade-in-up" style="animation-delay: 0.5s;">
                <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-clipboard-list mr-3"></i>Sample Schedule</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full border rounded-lg">
                        <thead>
                            <tr class="uppercase text-sm leading-normal bg-gray-100">
                                <th class="py-3 px-6 text-left">Time</th>
                                <th class="py-3 px-6 text-left">Activity</th>
                                <th class="py-3 px-6 text-left">Speaker/Performer</th>
                            </tr>
                        </thead>
                        <tbody id="outputSchedule" class="text-sm font-light">
                            </tbody>
                    </table>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="card slide-in-left" style="animation-delay: 0.6s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-paint-brush mr-3"></i>Poster Design Ideas</h3>
                    <ul id="outputPosterIdeas" class="list-disc list-inside space-y-2">
                        </ul>
                </div>
                <div class="card slide-in-right" style="animation-delay: 0.7s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-share-alt mr-3"></i>Social Media Caption & Hashtags</h3>
                    <p id="outputSocialMedia" class="leading-relaxed"></p>
                    <p id="outputHashtags" class="font-medium mt-2"></p>
                </div>
            </div>

            <div class="grid grid-cols-1 gap-6 mb-8">
                <div class="card fade-in-up" style="animation-delay: 0.8s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-users-cog mr-3"></i>Required Committees & Assigned Staff</h3>
                    <ul id="outputCommittees" class="list-disc list-inside space-y-2">
                        </ul>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="card slide-in-left" style="animation-delay: 1.0s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-chart-pie mr-3"></i>Budget Breakdown</h3>
                    <ul id="outputBudget" class="list-disc list-inside space-y-2">
                        </ul>
                </div>
                <div class="card slide-in-right" style="animation-delay: 1.1s;">
                    <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-lightbulb mr-3"></i>Decoration Suggestions</h3>
                    <ul id="outputDecorations" class="list-disc list-inside space-y-2">
                        </ul>
                </div>
            </div>

            <div class="card mb-8 fade-in-up" style="animation-delay: 1.2s;">
                <h3 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-envelope-open-text mr-3"></i>Letter of Permission</h3>
                <pre id="outputLetter" class="p-4 rounded-lg text-sm whitespace-pre-wrap font-mono leading-relaxed border"></pre>
            </div>

            <div class="flex flex-col sm:flex-row justify-center gap-4 mt-8 fade-in-up" style="animation-delay: 1.3s;">
                <button id="downloadPdfBtn"
                        class="btn-primary font-bold py-3 px-6 rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-green-300 scale-in" style="animation-delay: 1.4s;">
                    <i class="fas fa-download mr-2"></i>Download Checklist & Letter (PDF)
                </button>
                <button id="editPlanBtn"
                        class="btn-primary font-bold py-3 px-6 rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-yellow-300 scale-in" style="animation-delay: 1.5s;">
                    <i class="fas fa-edit mr-2"></i>Edit Plan
                </button>
                <button id="startNewBtn"
                        class="btn-primary font-bold py-3 px-6 rounded-full shadow-lg focus:outline-none focus:ring-4 focus:ring-red-300 scale-in" style="animation-delay: 1.6s;">
                    <i class="fas fa-plus mr-2"></i>Start New
                </button>
            </div>
        </div>
    </main>

    <div id="customModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <p id="modalMessage" class="text-lg mb-4"></p>
            <div id="modalActions" class="flex justify-center gap-4">
                </div>
        </div>
    </div>

    <script>
        // Get DOM elements
        const eventForm = document.getElementById('eventForm');
        const modeSelect = document.getElementById('mode');
        const venueGroup = document.getElementById('venueGroup');
        const venueInput = document.getElementById('venue');
        const autofillVenueBtn = document.getElementById('autofillVenueBtn');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const planOutput = document.getElementById('planOutput');

        const outputTitle = document.getElementById('outputTitle');
        const outputDescription = document.getElementById('outputDescription');
        const outputSchedule = document.getElementById('outputSchedule');
        const outputPosterIdeas = document.getElementById('outputPosterIdeas');
        const outputSocialMedia = document.getElementById('outputSocialMedia');
        const outputHashtags = document.getElementById('outputHashtags');
        const outputCommittees = document.getElementById('outputCommittees');
        const outputBudget = document.getElementById('outputBudget');
        const outputLetter = document.getElementById('outputLetter');
        const outputDecorations = document.getElementById('outputDecorations');

        // New elements for sports suggestions
        const sportsContentDiv = document.getElementById('sportsContent');
        const outputSportsNames = document.getElementById('outputSportsNames');
        const outputSportsQuotes = document.getElementById('outputSportsQuotes');


        const downloadPdfBtn = document.getElementById('downloadPdfBtn');
        const editPlanBtn = document.getElementById('editPlanBtn');
        const startNewBtn = document.getElementById('startNewBtn');

        // Modal elements
        const customModal = document.getElementById('customModal');
        const modalMessage = document.getElementById('modalMessage');
        const modalActions = document.getElementById('modalActions');
        const closeModalButton = customModal.querySelector('.close-button');

        // Global variable to store the generated plan for PDF generation
        let currentPlanData = {};

        // Staff Data - Updated for clear Professor designation
        const staffData = [
           
            { name: "Prof. Pravin Uttam Chokakkar", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Gaikwad Aditya Vikas", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Kinhago Joshi", designation: "Professor", department: "C.S.E" },
            { name: "Dr. Ajaj Singh", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Srirang Batra", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Devesh Nandan Upadhyay", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Vikas Kumar", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Raghvendra Singh Kuwar", designation: "Professor", department: "C.S.E" },
            { name: "Dr. Nina Ramasahoo Chopde", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Utkarsh Nilgal Madanshu", designation: "Professor", department: "C.S.E" },
            { name: "Prof. Nachiketa Subodh Salun", designation: "Professor", department: "CS" },
            { name: "Dr. Prashant Shivraj Dhami", designation: "Professor", department: "CS" },
            { name: "Dr. Muskan Agrawal", designation: "Professor", department: "CS" },
            { name: "Dr. Aparupa Chakraborty", designation: "Professor", department: "AI&DS" },
            { name: "Dr. Ankur Jain", designation: "Professor", department: "AI&DS" },
            { name: "Dr. Tanay Renu Ghosh", designation: "Professor", department: "AI&DS" },
            { name: "Prof. Dhruvraj Vitthalrao Pathak", designation: "Professor", department: "AI&ML" },
            { name: "Prof. Soundharya Goyen", designation: "Professor", department: "AI&ML" },
            { name: "Prof. Sonali Lalu", designation: "Professor", department: "AI&ML" },
            { name: "Prof. Kajal Hardal Khobragade", designation: "Professor", department: "AI&ML" },
            { name: "Prof. Jai Rastogi", designation: "Professor", department: "AI&ML" },
            { name: "Prof. Aujwal Shaikh", designation: "Professor", department: "AI&ML" },
            { name: "Prof. Nitin Vilasrao Sanjay", designation: "Professor", department: "BBA" },
            { name: "Prof. Jadhav Harshada Rajendra", designation: "Professor", department: "BBA" },
            { name: "Prof. Devendra Dattatray Kote", designation: "Professor", department: "BBA" },
            { name: "Dr. Kulkarni K", designation: "Professor", department: "BBA" },
            { name: "Prof. Jayheri Jayraj Bhabu", designation: "Professor", department: "BBA" },
            { name: "Dr. Eswaran Karunahakati", designation: "Professor", department: "MBA" },
            { name: "Prof. Rajeswari Mahakali", designation: "Professor", department: "MBA" },
            { name: "Prof. Nikita Wahi", designation: "Professor", department: "B.COM" },
        ];

        // Function to show custom modal
        function showCustomModal(message, type = 'alert', onConfirm = null) {
            modalMessage.textContent = message;
            modalActions.innerHTML = ''; // Clear previous buttons

            if (type === 'alert') {
                const okButton = document.createElement('button');
                okButton.textContent = 'OK';
                okButton.className = 'bg-blue-700 text-white px-4 py-2 rounded-md hover:bg-blue-800 transition duration-200';
                okButton.onclick = () => customModal.classList.remove('show');
                modalActions.appendChild(okButton);
            } else if (type === 'confirm') {
                const confirmButton = document.createElement('button');
                confirmButton.textContent = 'Confirm';
                confirmButton.className = 'bg-green-700 text-white px-4 py-2 rounded-md hover:bg-green-800 transition duration-200';
                confirmButton.onclick = () => {
                    customModal.classList.remove('show');
                    if (onConfirm) onConfirm();
                };
                const cancelButton = document.createElement('button');
                cancelButton.textContent = 'Cancel';
                cancelButton.className = 'bg-gray-700 text-white px-4 py-2 rounded-md hover:bg-gray-800 transition duration-200';
                cancelButton.onclick = () => customModal.classList.remove('show');
                modalActions.appendChild(confirmButton);
                modalActions.appendChild(cancelButton);
            }
            customModal.classList.add('show');
        }

        // Close modal when close button is clicked
        closeModalButton.onclick = () => customModal.classList.remove('show');
        // Close modal when clicking outside of the content
        window.onclick = (event) => {
            if (event.target == customModal) {
                customModal.classList.remove('show');
            }
        };


        // Conditional display for Venue input
        modeSelect.addEventListener('change', () => {
            if (modeSelect.value === 'Offline' || modeSelect.value === 'Hybrid') {
                venueGroup.classList.remove('hidden');
                venueInput.setAttribute('required', 'true');
            } else {
                venueGroup.classList.add('hidden');
                venueInput.removeAttribute('required');
                venueInput.value = ''; // Clear venue if not applicable
            }
        });

        // Autofill Venue (Mock Geolocation)
        autofillVenueBtn.addEventListener('click', () => {
            if (navigator.geolocation) {
                showCustomModal("Requesting your location to autofill nearest venues...", "alert");
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        // Mock data for nearest colleges/venues (using a cool-tone inspired naming)
                        const mockVenues = [
                            "Innovation Hub Auditorium",
                            "Aqua Tech Lecture Hall",
                            "Crystal Lake Convention Center",
                            "Emerald Gardens Amphitheater",
                            "Blue Sky Research Lab"
                        ];
                        const randomVenue = mockVenues[Math.floor(Math.random() * mockVenues.length)];
                        venueInput.value = randomVenue;
                        showCustomModal(`Location found! Autofilled: ${randomVenue}`, "alert");
                    },
                    (error) => {
                        console.error("Geolocation error:", error);
                        showCustomModal("Could not retrieve your location. Please enter venue manually.", "alert");
                    },
                    { enableHighAccuracy: true, timeout: 5000, maximumAge: 0 }
                );
            } else {
                showCustomModal("Geolocation is not supported by your browser. Please enter venue manually.", "alert");
            }
        });

        // Mock AI Generation Function
        async function generateEventPlan(formData) {
            // Simulate API call delay
            await new Promise(resolve => setTimeout(resolve, 2000));

            const { eventType, audience, theme, eventDate, duration, mode, venue, budgetLimit } = formData;

            // Separate professors from other staff
            let availableProfessors = staffData.filter(staff => staff.designation.includes('Professor') || staff.designation.includes('HOD') || staff.designation.includes('Director'));
            let nonProfessorStaff = staffData.filter(staff => !staff.designation.includes('Professor') && !staff.designation.includes('HOD') && !staff.designation.includes('Director'));

            // Function to get a unique professor and a specified number of volunteers
            function assignCommitteeMembers(committeeName, targetVolunteers, departmentKeywords = []) {
                let assignedProfessor = null;
                let selectedVolunteers = new Set();
                let members = [];

                // Assign one unique professor
                if (availableProfessors.length > 0) {
                    // Try to find a relevant professor first
                    const relevantProfIndex = availableProfessors.findIndex(p => departmentKeywords.some(keyword => p.department.includes(keyword)));
                    if (relevantProfIndex !== -1) {
                        assignedProfessor = availableProfessors[relevantProfIndex];
                        availableProfessors.splice(relevantProfIndex, 1); // Remove assigned professor
                    } else {
                        // If no relevant professor, pick any available professor
                        assignedProfessor = availableProfessors.shift(); // Take the first available professor
                    }
                    if (assignedProfessor) {
                        members.push(`Prof. ${assignedProfessor.name.split(' ').slice(1).join(' ')}`);
                    }
                }

                // Assign volunteers (non-professor staff)
                const relevantVolunteers = nonProfessorStaff.filter(s => departmentKeywords.some(keyword => s.department.includes(keyword)));
                for (let i = 0; i < relevantVolunteers.length && selectedVolunteers.size < targetVolunteers; i++) {
                    selectedVolunteers.add(relevantVolunteers[i].name);
                }

                if (selectedVolunteers.size < targetVolunteers) {
                    for (let i = 0; i < nonProfessorStaff.length && selectedVolunteers.size < targetVolunteers; i++) {
                        if (!selectedVolunteers.has(nonProfessorStaff[i].name)) { // Ensure unique volunteers
                             selectedVolunteers.add(nonProfessorStaff[i].name);
                        }
                    }
                }

                Array.from(selectedVolunteers).forEach(name => members.push(name));

                return {
                    professor: assignedProfessor ? assignedProfessor.name : 'N/A', // Store full name of assigned professor
                    profCount: assignedProfessor ? 1 : 0,
                    volunteers: Array.from(selectedVolunteers),
                    volunteerCount: Array.from(selectedVolunteers).length,
                    members: members // For display
                };
            }


            let committees = [];
            let assignedCommittees = {}; // Object to hold committee and assigned staff names
            let budgetBreakdown = [];
            let schedule = [];
            let posterIdeas = [];
            let socialMediaCaption = "";
            let hashtags = "";
            let eventTitle = "";
            let eventDescription = "";
            let decorationSuggestions = [];
            let sportsSeminarNames = []; // New
            let sportsQuotes = []; // New

            // Core Committees with Professor and Volunteer requirements
            assignedCommittees['Saraswati Pujan Team'] = assignCommitteeMembers('Saraswati Pujan Team', 3, ['Administration', 'SOFL']);
            assignedCommittees['Anchor Committee'] = assignCommitteeMembers('Anchor Committee', 2, ['SOFL', 'Administration']);
            assignedCommittees['Photographer Team'] = assignCommitteeMembers('Photographer Team', 2, ['Non-Teaching', 'C.S.E', 'AI&ML']);
            assignedCommittees['Decoration Team'] = assignCommitteeMembers('Decoration Team', 4, ['Administration', 'Non-Teaching', 'SOPS']);
            assignedCommittees['Volunteer Committee'] = assignCommitteeMembers('Volunteer Committee', 10, ['BBA', 'MBA', 'SOPS', 'Administration']);


            // Initial Schedule Entry
            schedule.push({ time: '09:00 AM', activity: 'Inaugural Ceremony & Welcome', speaker: 'Saraswati Pujan Team / Event Hosts' });


            // Determine additional committees and adjust schedule based on event type
            switch (eventType) {
                case 'Seminar':
                case 'Workshop':
                case 'Webinar':
                    assignedCommittees['Logistics Committee'] = assignCommitteeMembers('Logistics Committee', 5, ['Administration', 'SOPS']);
                    assignedCommittees['Publicity Committee'] = assignCommitteeMembers('Publicity Committee', 3, ['Administration', 'BBA']);
                    assignedCommittees['Technical Committee'] = assignCommitteeMembers('Technical Committee', 4, ['C.S.E', 'AI&ML', 'CS', 'AI&DS']);
                    assignedCommittees['Hospitality Committee'] = assignCommitteeMembers('Hospitality Committee', 3, ['Administration', 'SOFL']);

                    eventTitle = `Future Frontiers: A ${eventType} on ${theme}`;
                    eventDescription = `Explore the cutting-edge of "${theme}" in this insightful ${eventType} designed for ${audience}. Dive deep into new concepts and gain valuable knowledge.`;
                    schedule.push(
                        { time: '10:00 AM', activity: 'Registration & Networking', speaker: 'Event Team' },
                        { time: '10:30 AM', activity: `Keynote Address: Innovations in ${theme}`, speaker: 'Dr. Isabella Chen' },
                        { time: '11:30 AM', activity: 'Interactive Session: Applying ${theme} Concepts', speaker: 'Expert Panel' },
                        { time: '01:00 PM', activity: 'Lunch Break & Discussions', speaker: '' }
                    );
                    posterIdeas = [
                        `Sleek, futuristic design with glowing circuit patterns on a deep blue background.`,
                        `Minimalist design with cool-tone gradients and abstract data visualizations.`
                    ];
                    socialMediaCaption = `💡 Dive into the future! Join our "${eventTitle}" ${eventType} on ${eventDate}. Discover breakthroughs in "${theme}"! Register now!`;
                    hashtags = `#${eventType.replace(/\s/g, '')} #${theme.replace(/\s/g, '')} #FutureTech #Innovation`;
                    decorationSuggestions = [
                        `Blue and green LED strip lights, digital projection mapping.`,
                        `Geometric shapes and reflective surfaces for a modern, techy feel.`,
                        `Minimalistic stage design with a focus on lighting.`
                    ];

                    // Specific for Sports Seminar
                    if (theme.toLowerCase().includes('sport') || theme.toLowerCase().includes('fitness') || theme.toLowerCase().includes('athletic')) {
                        sportsSeminarNames = [
                            `The Winning Edge: Strategies for Peak Performance`,
                            `Mind Games: Psychology of Sports Success`,
                            `Beyond the Game: Sports for Life`,
                            `Future of Athletics: Tech & Training`,
                            `Unleash Your Inner Champion`
                        ];
                        sportsQuotes = [
                            `"The only way to prove that you’re a good sport is to lose." - Ernie Banks`,
                            `"I hated every minute of training, but I said, 'Don’t quit. Suffer now and live the rest of your life as a champion.'" - Muhammad Ali`,
                            `"It's not whether you get knocked down; it's whether you get up." - Vince Lombardi`,
                            `"You miss 100% of the shots you don’t take." - Wayne Gretzky`,
                            `"Champions keep playing until they get it right." - Billie Jean King`
                        ];
                    }
                    break;
                case 'Fest':
                case 'Cultural Event':
                case 'Sports Event': // Also include Sports Event here
                    assignedCommittees['Logistics Committee'] = assignCommitteeMembers('Logistics Committee', 10, ['Administration', 'SOPS']);
                    assignedCommittees['Publicity Committee'] = assignCommitteeMembers('Publicity Committee', 7, ['Administration', 'BBA']);
                    assignedCommittees['Hospitality Committee'] = assignCommitteeMembers('Hospitality Committee', 5, ['Administration', 'SOFL']);
                    assignedCommittees['Sponsorship Committee'] = assignCommitteeMembers('Sponsorship Committee', 5, ['BBA', 'MBA']);
                    assignedCommittees['Security Committee'] = assignCommitteeMembers('Security Committee', 7, ['Administration', 'PE']);
                    assignedCommittees['Event Management Committee'] = assignCommitteeMembers('Event Management Committee', 10, ['Administration', 'BBA', 'MBA']);

                    eventTitle = `Harmonic Convergence: University ${eventType}`;
                    eventDescription = `Experience the vibrant energy of "${eventTitle}"! A grand ${eventType} celebrating "${theme}" for ${audience}, blending cultural richness with cool aesthetics.`;
                    schedule.push(
                        { time: '10:00 AM', activity: 'Gates Open & Welcome', speaker: '' },
                        { time: '10:30 AM', activity: 'Inauguration Ceremony & Cultural Performances', speaker: 'University Dignitaries' },
                        { time: '11:00 AM', activity: 'Interactive Workshops / Sports Competitions', speaker: 'Various Groups' },
                        { time: '02:00 PM', activity: 'Food Stalls & Leisure Activities', speaker: '' }
                    );
                    posterIdeas = [
                        `Dynamic abstract shapes in blue, green, and purple, symbolizing convergence.`,
                        `Collage of diverse cultural elements or sports imagery with a cool-tone overlay.`
                    ];
                    socialMediaCaption = `🎉 Get ready for "${eventTitle}"! Join us on ${eventDate} for an unforgettable ${eventType} filled with ${theme} and vibrant experiences. Don't miss out!`;
                    hashtags = `#${eventType.replace(/\s/g, '')} #${theme.replace(/\s/g, '')} #CulturalVibes #SportsFiesta`;
                    decorationSuggestions = [
                        `Flowing fabrics in cool colors (blue, silver, white).`,
                        `Ambient lighting with cool gels and spotlights.`,
                        `Art installations with geometric patterns or reflective surfaces.`
                    ];

                    // Specific for Sports Event
                    if (eventType === 'Sports Event') {
                        sportsSeminarNames = [
                            `Varsity Victory: Sportsmanship & Success`,
                            `Athletic Apex: Reaching Your Potential`,
                            `Game Changers: Innovation in University Sports`,
                            `The Spirit of Competition: A Sports Summit`
                        ];
                        sportsQuotes = [
                            `"Winners never quit and quitters never win." - Vince Lombardi`,
                            `"The harder the battle, the sweeter the victory." - Les Brown`,
                            `"Sports do not build character. They reveal it." - Heywood Broun`,
                            `"It's not the will to win that matters—everyone has that. It's the will to prepare to win that matters." - Paul Bryant`
                        ];
                    }
                    break;
                case 'Hackathon':
                    assignedCommittees['Logistics Committee'] = assignCommitteeMembers('Logistics Committee', 8, ['Administration', 'SOPS']);
                    assignedCommittees['Publicity Committee'] = assignCommitteeMembers('Publicity Committee', 5, ['Administration', 'BBA']);
                    assignedCommittees['Technical Committee'] = assignCommitteeMembers('Technical Committee', 10, ['C.S.E', 'AI&ML', 'CS', 'AI&DS']);
                    assignedCommittees['Sponsorship Committee'] = assignCommitteeMembers('Sponsorship Committee', 4, ['BBA', 'MBA']);
                    assignedCommittees['Mentorship Committee'] = assignCommitteeMembers('Mentorship Committee', 6, ['C.S.E', 'AI&ML', 'CS', 'AI&DS']);

                    eventTitle = `Code Nexus: ${theme} Hackathon`;
                    eventDescription = `Connect at Code Nexus: ${theme} Hackathon! A challenging coding event for ${audience} to innovate and build solutions around "${theme}".`;
                    schedule.push(
                        { time: '10:00 AM', activity: 'Opening Ceremony & Problem Statement Reveal', speaker: 'Organizers' },
                        { time: '11:00 AM', activity: 'Coding Commences!', speaker: 'Participants' },
                        { time: '08:00 PM', activity: 'Mentor Sessions & Code Review', speaker: 'Industry Experts' },
                        { time: '09:00 AM (Next Day)', activity: 'Project Submissions & Judging', speaker: '' }
                    );
                    posterIdeas = [
                        `Abstract geometric patterns resembling circuitry in cool blues and greens.`,
                        `Minimalist design with lines of code forming an architectural shape.`
                    ];
                    socialMediaCaption = `💻 Code, create, conquer! 🚀 Join our ${theme} Hackathon on ${eventDate}. Build, innovate, and connect! Register your team now!`;
                    hashtags = `#Hackathon #${theme.replace(/\s/g, '')} #CodingChallenge #TechInnovation`;
                    decorationSuggestions = [
                        `Blue and white light accents, modern furniture.`,
                        `Screens displaying live coding sessions or data visualizations.`,
                        `Comfortable, collaborative workspaces with good lighting.`
                    ];
                    break;
                case 'Exhibition':
                    assignedCommittees['Logistics Committee'] = assignCommitteeMembers('Logistics Committee', 10, ['Administration', 'SOPS']);
                    assignedCommittees['Publicity Committee'] = assignCommitteeMembers('Publicity Committee', 7, ['Administration', 'BBA']);
                    assignedCommittees['Hospitality Committee'] = assignCommitteeMembers('Hospitality Committee', 5, ['Administration', 'SOFL']);
                    assignedCommittees['Stall Management Committee'] = assignCommitteeMembers('Stall Management Committee', 8, ['Administration', 'BBA', 'MBA']);
                    assignedCommittees['Security Committee'] = assignCommitteeMembers('Security Committee', 5, ['Administration', 'PE']);

                    eventTitle = `Innovation Showcase: The ${theme} Expo`;
                    eventDescription = `Step into the future at Innovation Showcase: The ${theme} Expo! An exhibition presenting groundbreaking projects and ideas from ${audience}, focusing on cool and sustainable innovations.`;
                    schedule.push(
                        { time: '10:00 AM', activity: 'Exhibition Gates Open', speaker: '' },
                        { time: '10:30 AM', activity: 'Inauguration & Ribbon Cutting', speaker: 'Chief Guest' },
                        { time: '11:00 AM', activity: 'Stall Demonstrations & Interactive Displays', speaker: 'Exhibitors' },
                        { time: '03:00 PM', activity: 'Panel Discussion on Future Trends', speaker: 'Industry Experts' }
                    );
                    posterIdeas = [
                        `Clean, modern design with product mockups and cool-tone color palettes.`,
                        `Architectural lines and light effects highlighting key innovations.`
                    ];
                    socialMediaCaption = `🔬 Discover innovation at The ${theme} Expo on ${eventDate}! Witness groundbreaking projects and connect with brilliant minds. Don't miss this future-forward event!`;
                    hashtags = `#Exhibition #${theme.replace(/\s/g, '')} #InnovationExpo #FutureTech`;
                    decorationSuggestions = [
                        `Bright, clean lighting with blue/white accents.`,
                        `Sleek display stands and clear signage.`,
                        `Interactive exhibits with touchscreens and projection.`
                    ];
                    break;
                default:
                    assignedCommittees['Logistics Committee'] = assignCommitteeMembers('Logistics Committee', 5, ['Administration', 'SOPS']);
                    assignedCommittees['Publicity Committee'] = assignCommitteeMembers('Publicity Committee', 3, ['Administration', 'BBA']);
                    assignedCommittees['Hospitality Committee'] = assignCommitteeMembers('Hospitality Committee', 3, ['Administration', 'SOFL']);

                    eventTitle = `The ${theme} ${eventType}: University Edition`;
                    eventDescription = `Join us for a fantastic ${eventType} on "${theme}" for ${audience}. Expect an engaging and informative experience!`;
                    schedule.push(
                        { time: '10:00 AM', activity: 'Opening Remarks', speaker: 'Organizers' },
                        { time: '11:00 AM', activity: 'Main Activity', speaker: '' },
                        { time: '01:00 PM', activity: 'Break', speaker: '' },
                        { time: '02:00 PM', activity: 'Closing Remarks', speaker: '' }
                    );
                    posterIdeas = [
                        `Clean, crisp design with cool tones and minimal text.`,
                        `Abstract patterns reflecting the theme, with a modern feel.`
                    ];
                    socialMediaCaption = `Get ready for our ${eventType} - "${eventTitle}" on ${eventDate}! It's going to be great.`;
                    hashtags = `#UniversityEvent #${eventType.replace(/\s/g, '')} #${theme.replace(/\s/g, '')} #CampusLife`;
                    decorationSuggestions = [
                        `Soft blue and white lighting.`,
                        `Simple, elegant backdrops.`,
                        `Comfortable seating arrangements.`
                    ];
            }

            // Budget Breakdown (simplified mock)
            const budget = parseFloat(budgetLimit);
            budgetBreakdown = [
                { item: 'Venue Rental (if applicable)', cost: (mode === 'Online' ? 0 : budget * 0.3).toFixed(2) },
                { item: 'Food & Beverages', cost: (budget * 0.25).toFixed(2) },
                { item: 'Technical Setup', cost: (budget * 0.2).toFixed(2) },
                { item: 'Marketing & Publicity', cost: (budget * 0.15).toFixed(2) },
                { item: 'Miscellaneous / Contingency', cost: (budget * 0.1).toFixed(2) }
            ];

            // Letter of Permission (template)
            const letter = `
[Your Club Name/Logo]
[Your Club Address]
[Your Club Contact Number]
[Your Club Email]

[Date: ${new Date().toLocaleDateString('en-GB')}]

The Dean/Principal,
[University Name],
[University Address].

Subject: Request for Permission to Organize "${eventTitle}"

Dear Sir/Madam,

We, the [Your Club Name] of [University Name], would like to seek your kind permission to organize an event titled "${eventTitle}" on ${eventDate} for a duration of ${duration} day(s). The event will be a ${eventType} with the theme "${theme}", targeting ${audience}.

The mode of the event will be ${mode}. ${mode !== 'Online' ? `The proposed venue for the event is ${venue}.` : ''}

The estimated budget for this event is approximately INR ${budgetLimit}. We assure you that all necessary arrangements will be made to ensure the smooth and successful execution of the event, adhering to all university guidelines and regulations.

We believe this event will greatly benefit the students and enhance the university's reputation. We are committed to ensuring a well-organized and impactful experience for all participants.

We kindly request your approval and support for this initiative. We are available to discuss the detailed plan and address any concerns you may have at your earliest convenience.

Thank you for your time and consideration.

Sincerely,

[Your Name/Club President Name]
[Your Designation/Club President]
[Your Club Name]
            `.trim();


            return {
                eventTitle,
                eventDescription,
                schedule,
                posterIdeas,
                socialMediaCaption,
                hashtags,
                committees: assignedCommittees, // Pass assigned staff directly
                budgetBreakdown,
                letter,
                decorationSuggestions,
                sportsSeminarNames, // New
                sportsQuotes // New
            };
        }

        // Handle form submission
        eventForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            // Simple validation: highlight empty required fields
            let allFieldsValid = true;
            const requiredInputs = eventForm.querySelectorAll('[required]');
            requiredInputs.forEach(input => {
                if (!input.value.trim()) {
                    input.classList.add('border-red-500', 'ring-2', 'ring-red-200');
                    allFieldsValid = false;
                } else {
                    input.classList.remove('border-red-500', 'ring-2', 'ring-red-200');
                }
            });

            if (!allFieldsValid) {
                showCustomModal("Please fill in all required fields.", "alert");
                return;
            }

            // Collect form data
            const formData = {
                eventType: document.getElementById('eventType').value,
                audience: document.getElementById('audience').value,
                theme: document.getElementById('theme').value,
                eventDate: document.getElementById('eventDate').value,
                duration: parseFloat(document.getElementById('duration').value),
                mode: document.getElementById('mode').value,
                venue: document.getElementById('venue').value,
                budgetLimit: parseFloat(document.getElementById('budgetLimit').value)
            };

            // Show loading spinner and hide form
            eventForm.classList.add('hidden');
            loadingSpinner.classList.remove('hidden');
            planOutput.classList.add('hidden'); // Ensure output is hidden until ready

            try {
                const plan = await generateEventPlan(formData);
                currentPlanData = plan; // Store the generated plan globally
                displayEventPlan(plan);
            } catch (error) {
                console.error("Error generating plan:", error);
                showCustomModal("An error occurred while generating the plan. Please try again.", "alert");
            } finally {
                loadingSpinner.classList.add('hidden');
                planOutput.classList.remove('hidden');
                // Apply fade-in-up, slide-in-left/right, scale-in animation to relevant elements
                Array.from(planOutput.children).forEach(child => {
                    if (child.classList.contains('fade-in-up') || child.classList.contains('slide-in-left') || child.classList.contains('slide-in-right') || child.classList.contains('scale-in')) {
                        child.style.animation = 'none'; // Reset animation
                        void child.offsetWidth; // Trigger reflow
                        child.style.animation = null; // Reapply animation
                    }
                });
            }
        });

        // Function to display the generated plan
        function displayEventPlan(plan) {
            outputTitle.textContent = plan.eventTitle;
            outputDescription.textContent = plan.eventDescription;

            // Schedule
            outputSchedule.innerHTML = '';
            plan.schedule.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 hover:bg-gray-50';
                row.innerHTML = `
                    <td class="py-3 px-6 text-left whitespace-nowrap">${item.time}</td>
                    <td class="py-3 px-6 text-left">${item.activity}</td>
                    <td class="py-3 px-6 text-left">${item.speaker}</td>
                `;
                outputSchedule.appendChild(row);
            });

            // Poster Ideas
            outputPosterIdeas.innerHTML = '';
            plan.posterIdeas.forEach(idea => {
                const li = document.createElement('li');
                li.textContent = idea;
                outputPosterIdeas.appendChild(li);
            });

            // Social Media
            outputSocialMedia.textContent = plan.socialMediaCaption;
            outputHashtags.textContent = plan.hashtags;

            // Committees and Assigned Staff
            outputCommittees.innerHTML = '';
            for (const committeeName in plan.committees) {
                if (plan.committees.hasOwnProperty(committeeName)) {
                    const li = document.createElement('li');
                    const committeeData = plan.committees[committeeName];
                    const membersList = committeeData.members.length > 0
                        ? `: ${committeeData.members.join(', ')}`
                        : ': (No staff assigned yet)';

                    li.textContent = `${committeeName}${membersList} (Professors: ${committeeData.profCount}, Volunteers: ${committeeData.volunteerCount})`;
                    outputCommittees.appendChild(li);
                }
            }

            // Budget Breakdown
            outputBudget.innerHTML = '';
            plan.budgetBreakdown.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.item}: INR ${item.cost}`;
                outputBudget.appendChild(li);
            });

            // Letter of Permission
            outputLetter.textContent = plan.letter;

            // Decoration Suggestions
            outputDecorations.innerHTML = '';
            plan.decorationSuggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                outputDecorations.appendChild(li);
            });

            // Display Sports Seminar Names & Quotes if available
            if ((plan.eventType === 'Seminar' && (plan.theme.toLowerCase().includes('sport') || plan.theme.toLowerCase().includes('fitness') || plan.theme.toLowerCase().includes('athletic'))) || plan.eventType === 'Sports Event') {
                sportsContentDiv.classList.remove('hidden');
                outputSportsNames.innerHTML = '';
                plan.sportsSeminarNames.forEach(name => {
                    const li = document.createElement('li');
                    li.textContent = name;
                    outputSportsNames.appendChild(li);
                });
                outputSportsQuotes.innerHTML = '';
                plan.sportsQuotes.forEach(quote => {
                    const li = document.createElement('li');
                    li.textContent = `"${quote}"`;
                    outputSportsQuotes.appendChild(li);
                });
            } else {
                sportsContentDiv.classList.add('hidden');
            }
        }

        // Download PDF
        downloadPdfBtn.addEventListener('click', () => {
            if (!currentPlanData || Object.keys(currentPlanData).length === 0) {
                showCustomModal("Please generate an event plan first before downloading.", "alert");
                return;
            }

            showCustomModal("Generating PDF...", "alert");
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Add Event Plan Summary
            doc.setFontSize(22);
            doc.setTextColor(0, 100, 200); // Blue for headings
            doc.text("AI University Event Plan Summary - Cool Tone Edition", 105, 20, null, null, "center");
            doc.setFontSize(12);
            doc.setTextColor(224, 224, 224); // Lighter text
            doc.text(`Event Title: ${currentPlanData.eventTitle}`, 10, 35);
            doc.text(`Description: ${currentPlanData.eventDescription.substring(0, 100)}...`, 10, 45); // Truncate for summary
            doc.text(`Date: ${document.getElementById('eventDate').value}`, 10, 55);
            doc.text(`Mode: ${document.getElementById('mode').value}`, 10, 65);
            doc.text(`Budget: INR ${document.getElementById('budgetLimit').value}`, 10, 75);

            let yOffset = 85; // Starting Y position for new content

            // Add Sports Seminar Names & Quotes if applicable
            if ((currentPlanData.eventType === 'Seminar' && (currentPlanData.theme.toLowerCase().includes('sport') || currentPlanData.theme.toLowerCase().includes('fitness') || currentPlanData.theme.toLowerCase().includes('athletic'))) || currentPlanData.eventType === 'Sports Event') {
                doc.addPage();
                doc.setFontSize(18);
                doc.setTextColor(0, 100, 200);
                doc.text("Sports Seminar Name Ideas", 105, 20, null, null, "center");
                doc.setFontSize(12);
                doc.setTextColor(224, 224, 224);
                yOffset = 30;
                currentPlanData.sportsSeminarNames.forEach(name => {
                    doc.text(`- ${name}`, 20, yOffset);
                    yOffset += 10;
                });

                doc.setFontSize(18);
                doc.setTextColor(0, 100, 200);
                doc.text("Motivational Sports Quotes", 105, yOffset + 10, null, null, "center");
                doc.setFontSize(12);
                doc.setTextColor(224, 224, 224);
                yOffset += 20;
                currentPlanData.sportsQuotes.forEach(quote => {
                    const splitQuote = doc.splitTextToSize(`"${quote}"`, 170); // Split long quotes
                    doc.text(splitQuote, 20, yOffset);
                    yOffset += (splitQuote.length * 10); // Adjust yOffset for multi-line quotes
                });
            }


            // Add Committees and Assigned Staff Checklist
            doc.addPage();
            doc.setFontSize(18);
            doc.setTextColor(0, 100, 200);
            doc.text("Required Committees & Assigned Staff Checklist", 105, 20, null, null, "center");
            doc.setFontSize(12);
            doc.setTextColor(224, 224, 224);
            let yPos = 40;
            for (const committeeName in currentPlanData.committees) {
                if (currentPlanData.committees.hasOwnProperty(committeeName)) {
                    const committeeData = currentPlanData.committees[committeeName];
                    const membersList = committeeData.members.length > 0
                        ? `: ${committeeData.members.join(', ')}`
                        : ': (No staff assigned yet)';
                    const profCount = committeeData.profCount;
                    const volunteerCount = committeeData.volunteerCount;

                    const lineText = `- ${committeeName}${membersList} (Professors: ${profCount}, Volunteers: ${volunteerCount})`;
                    const splitText = doc.splitTextToSize(lineText, 170);
                    doc.text(splitText, 20, yPos);
                    yPos += (splitText.length * 10); // Adjust yPos for multi-line entries
                    if (yPos > 280) { // Check for page overflow
                        doc.addPage();
                        yPos = 20;
                    }
                }
            }

            // Add Budget Breakdown
            doc.addPage();
            doc.setFontSize(18);
            doc.setTextColor(0, 100, 200);
            doc.text("Budget Breakdown", 105, 20, null, null, "center");
            doc.setFontSize(12);
            doc.setTextColor(224, 224, 224);
            yPos = 40;
            currentPlanData.budgetBreakdown.forEach(item => {
                doc.text(`- ${item.item}: INR ${item.cost}`, 20, yPos);
                yPos += 10;
            });

            // Add Letter of Permission
            doc.addPage();
            doc.setFontSize(18);
            doc.setTextColor(0, 100, 200);
            doc.text("Letter of Permission", 105, 20, null, null, "center");
            doc.setFontSize(12);
            doc.setTextColor(224, 224, 224);
            const letterText = currentPlanData.letter;
            const splitText = doc.splitTextToSize(letterText, 180); // Max width 180mm
            doc.text(splitText, 15, 30);

            doc.save("Event_Plan_Cool_Tone.pdf");
            showCustomModal("PDF generated successfully!", "alert");
        });

        // Edit Plan
        editPlanBtn.addEventListener('click', () => {
            showCustomModal("Do you want to edit the current plan?", "confirm", () => {
                planOutput.classList.add('hidden');
                eventForm.classList.remove('hidden');
            });
        });

        // Start New Plan
        startNewBtn.addEventListener('click', () => {
            showCustomModal("Are you sure you want to start a new plan? All current data will be lost.", "confirm", () => {
                eventForm.reset(); // Clear form fields
                venueGroup.classList.add('hidden'); // Hide venue field
                venueInput.removeAttribute('required');
                planOutput.classList.add('hidden'); // Hide output section
                eventForm.classList.remove('hidden'); // Show form
                // Clear any validation highlights
                eventForm.querySelectorAll('[required]').forEach(input => {
                    input.classList.remove('border-red-500', 'ring-2', 'ring-red-200');
                });
                currentPlanData = {}; // Clear stored plan data
                sportsContentDiv.classList.add('hidden'); // Hide sports section
            });
        });

        // Initialize date input to today's date
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0'); // Months start at 0!
            const dd = String(today.getDate()).padStart(2, '0');
            document.getElementById('eventDate').value = `${yyyy}-${mm}-${dd}`;
        });
    </script>
</body>
</html>
